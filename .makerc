
alias make='bear_make'

CCDB=compile_commands.json

bear_make() {
    local ec=0
	[[ -f "$CCDB" ]] && echo "rm $CCDB" && rm "$CCDB"
    if [[ "$1" =~ ^clean$ ]]; then
        /usr/bin/make "$@"
        ec=$?
    else
        bear --append -- /usr/bin/make "$@"
        ec=$?
    fi
    return $ec
}